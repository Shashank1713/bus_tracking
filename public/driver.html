<!DOCTYPE html>
<html>
<head>
<title>Driver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="/socket.io/socket.io.js"></script>
<script src="auth.js"></script>
</head>
<body>

<script>requireRole("driver");</script>

<h2>Driver GPS</h2>
<input id="busId" placeholder="Bus ID"><br><br>
<button onclick="start()">Start Sharing</button>
<button onclick="logout()">Logout</button>

<script>
const socket = io();

function start() {
    navigator.geolocation.watchPosition(pos => {
        socket.emit("busLocation", {
            busId: busId.value,
            lat: pos.coords.latitude,
            lon: pos.coords.longitude
        });
    }, err => alert(err.message), {
        enableHighAccuracy: true
    });

    alert("GPS started");
}
</script>

</body>
</html>
